<div class="admin-layout">
  <!-- Sidebar Navigation -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <div class="dashboard-container">
    <div class="top-bar">
      <div class="dashboard-header">
        <h1>Admin Dashboard</h1>
        <p class="dashboard-subtitle">Manage appointments and track your business metrics</p>
      </div>
      <div class="header-actions">
        <button class="notification-btn" aria-label="View messages">
          <span class="material-icons">mail</span>
        </button>
        <button class="notification-btn" aria-label="View notifications">
          <span class="material-icons">notifications</span>
          <span class="badge" *ngIf="getPendingCount() > 0">{{ getPendingCount() }}</span>
        </button>
      </div>
    </div>

    <!-- Quick Statistics -->
    <div class="stats-grid" *ngIf="!loading">
    <div class="stat-card pending">
      <div class="stat-icon"><span class="material-icons">schedule</span></div>
      <div class="stat-content">
        <h3>{{ getPendingCount() }}</h3>
        <p>Pending Appointments</p>
      </div>
    </div>

    <div class="stat-card approved">
      <div class="stat-icon"><span class="material-icons">check_circle</span></div>
      <div class="stat-content">
        <h3>{{ getApprovedCount() }}</h3>
        <p>Approved Appointments</p>
      </div>
    </div>

    <div class="stat-card completed">
      <div class="stat-icon"><span class="material-icons">celebration</span></div>
      <div class="stat-content">
        <h3>{{ getCompletedCount() }}</h3>
        <p>Completed Orders</p>
      </div>
    </div>

    <div class="stat-card total">
      <div class="stat-icon"><span class="material-icons">assessment</span></div>
      <div class="stat-content">
        <h3>{{ appointments.length }}</h3>
        <p>Total Appointments</p>
      </div>
    </div>
    </div>

    <!-- Upcoming Deadlines -->
    <div class="section upcoming-deadlines" *ngIf="!loading && getUpcomingDeadlines().length > 0">
    <h2>Upcoming Deadlines</h2>
    <div class="deadline-list">
      <div class="deadline-card" *ngFor="let appointment of getUpcomingDeadlines()">
        <div class="deadline-date">
          <span class="date">{{ appointment.deadline | date:'dd' }}</span>
          <span class="month">{{ appointment.deadline | date:'MMM' }}</span>
        </div>
        <div class="deadline-info">
          <h4>{{ appointment.customerName }}</h4>
          <p>{{ appointment.phoneNumber }}</p>
          <span class="status-badge" [class]="'status-' + appointment.status.toLowerCase()">
            {{ appointment.status }}
          </span>
        </div>
      </div>
    </div>
    </div>

    <!-- Filters -->
    <div class="section">
    <div class="section-header">
      <h2>All Appointments</h2>
      <div class="filters">
        <select id="status-filter" [(ngModel)]="selectedStatus" (change)="filterAppointments()" title="Filter appointments by status">
          <option *ngFor="let option of statusOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>
    </div>

    <!-- Appointments List -->
    <div class="appointments-list" *ngIf="!loading; else loadingTemplate">
      <div class="appointment-card" *ngFor="let appointment of filteredAppointments">
        <div class="appointment-header">
          <div class="customer-info">
            <h3>{{ appointment.customerName }}</h3>
            <p class="phone">{{ appointment.phoneNumber }}</p>
          </div>
          <span class="status" [class]="'status-' + appointment.status.toLowerCase()">
            {{ appointment.status }}
          </span>
        </div>
        
        <div class="appointment-details">
          <div class="detail-item">
            <span class="label">Age:</span>
            <span class="value">{{ appointment.age }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Deadline:</span>
            <span class="value">{{ appointment.deadline | date:'medium' }}</span>
          </div>
          <div class="detail-item full-width" *ngIf="appointment.notes">
            <span class="label">Notes:</span>
            <span class="value">{{ appointment.notes }}</span>
          </div>
        </div>

        <div class="appointment-actions" *ngIf="appointment.status === 'PENDING'">
          <button class="btn-approve" (click)="approveAppointment(appointment.id!)">
            ✓ Approve
          </button>
          <button class="btn-decline" (click)="declineAppointment(appointment.id!)">
            ✕ Decline
          </button>
        </div>
      </div>

      <div *ngIf="filteredAppointments.length === 0" class="no-appointments">
        <div class="empty-state">
          <span class="material-icons empty-icon">event_busy</span>
          <h3>No appointments found</h3>
          <p>There are no {{ selectedStatus === 'ALL' ? '' : selectedStatus.toLowerCase() }} appointments at the moment.</p>
        </div>
      </div>
    </div>

    <ng-template #loadingTemplate>
      <div class="loading">
        <div class="spinner"></div>
        <p>Loading appointments...</p>
      </div>
    </ng-template>
  </div>
</div>
