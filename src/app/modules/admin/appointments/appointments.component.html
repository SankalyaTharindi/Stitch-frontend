<div class="admin-layout">
  <app-shared-sidebar [title]="'Stitch'" [navItems]="adminNavItems"></app-shared-sidebar>
  
  <div class="appointments-container">
    <div class="page-header">
      <h1>All Appointments</h1>
    </div>

    <div *ngIf="loading" class="loading">
      <div class="spinner"></div>
      <p>Loading appointments...</p>
    </div>

    <div *ngIf="!loading && appointments.length === 0" class="empty-state">
      <span class="material-icons empty-icon">event_busy</span>
      <h3>No Appointments Found</h3>
      <p>There are no appointments to display.</p>
    </div>

    <div *ngIf="!loading && appointments.length > 0" class="appointments-grid">
      <div *ngFor="let appointment of appointments" class="appointment-card">
        <div class="card-header">
          <div class="status-badge" [style.background-color]="getStatusColor(appointment.status)">
            {{ getStatusLabel(appointment.status) }}
          </div>
        </div>

        <div class="card-body">
          <div class="customer-name">
            <span class="material-icons">person</span>
            <span>{{ appointment.customerName }}</span>
          </div>

          <div class="detail-item">
            <span class="material-icons">phone</span>
            <span>{{ appointment.phoneNumber }}</span>
          </div>

          <div class="detail-item">
            <span class="material-icons">person_outline</span>
            <span>Age: {{ appointment.age }}</span>
          </div>

          <div class="detail-item">
            <span class="material-icons">event</span>
            <span>{{ appointment.deadline | date: 'medium' }}</span>
          </div>

          <div *ngIf="appointment.notes" class="notes-section">
            <div class="notes-content">
              <span class="label">Notes:</span>
              <p>{{ appointment.notes }}</p>
            </div>
          </div>

          <div *ngIf="appointment.declineReason" class="decline-reason">
            <span class="material-icons">info</span>
            <div class="decline-content">
              <span class="label">Decline Reason:</span>
              <p>{{ appointment.declineReason }}</p>
            </div>
          </div>
        </div>

        <div class="card-footer">
          <button 
            *ngIf="hasImages(appointment)" 
            class="btn-view-images" 
            (click)="viewImage(appointment)">
            <span class="material-icons">photo_library</span>
            View Images ({{ getImageCount(appointment.inspoImageUrl || '') }})
          </button>
          <span *ngIf="!hasImages(appointment)" class="no-images">No inspiration pictures</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Image Modal -->
<div *ngIf="showImageModal" class="image-modal-overlay" (click)="closeImageModal()">
  <div class="image-modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close-btn" (click)="closeImageModal()">
      <span class="material-icons">close</span>
    </button>
    
    <img [src]="modalImageUrl" alt="Inspiration image" class="modal-image">
    
    <div class="image-navigation" *ngIf="totalImages > 1">
      <button 
        class="nav-btn prev-btn" 
        (click)="previousImage()" 
        [disabled]="currentImageIndex === 0">
        <span class="material-icons">chevron_left</span>
      </button>
      
      <span class="image-counter">{{ currentImageIndex + 1 }} / {{ totalImages }}</span>
      
      <button 
        class="nav-btn next-btn" 
        (click)="nextImage()" 
        [disabled]="currentImageIndex === totalImages - 1">
        <span class="material-icons">chevron_right</span>
      </button>
    </div>
  </div>
</div>
