import{e as n,k as i,ma as c,n as u,q as s,ua as a}from"./chunk-ZXFXI32P.js";var p=(()=>{class o{constructor(e,t){this.http=e,this.router=t,this.API_URL="http://localhost:8080/api/auth";let r=localStorage.getItem("currentUser");this.currentUserSubject=new n(r?JSON.parse(r):null),this.currentUser=this.currentUserSubject.asObservable()}get currentUserValue(){return this.currentUserSubject.value}login(e,t){return this.http.post(`${this.API_URL}/login`,{email:e,password:t}).pipe(i(r=>{localStorage.setItem("token",r.token),localStorage.setItem("currentUser",JSON.stringify(r.user)),this.currentUserSubject.next(r.user)}))}register(e){return this.http.post(`${this.API_URL}/register`,e).pipe(i(t=>{localStorage.setItem("token",t.token),localStorage.setItem("currentUser",JSON.stringify(t.user)),this.currentUserSubject.next(t.user)}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.navigate(["/auth/login"])}getToken(){return localStorage.getItem("token")}isLoggedIn(){return!!this.getToken()}hasRole(e){return this.currentUserValue?.role===e}static{this.\u0275fac=function(t){return new(t||o)(s(c),s(a))}}static{this.\u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{p as a};
